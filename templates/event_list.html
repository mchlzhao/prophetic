{% extends 'base.html' %}
{% block content %}

<h1 class="text-light">{{ group.name }}:</h1>

<div class="container mt-3 mb-3">
    <div class="row">
        <div class="list-group w-100">
            {% for event in events %}
            <a href="{% url 'markets' event.pk %}" class="list-group-item list-group-item-dark list-group-item-action">{{ event.name }}</a>
            {% endfor %}
        </div>
    </div>
</div>

<div class="mt-3 mb-3 pt-3 pb-3 border-top">
    <a class="btn btn-outline-success" href="{% url 'event_create' group.pk %}">New Event</a>
    <form class="mt-3 mb-3" onkeydown="return event.key != 'Enter';">
        <fieldset>
            <input type="text" class="form-control w-auto" id="username_field" placeholder="Username">
            <small id="add_member_feedback" class="form-text text-muted"></small>
            <button class="btn btn-outline-secondary mt-1" type="button" id="add_member_button">Add Member</button>
        </fieldset>
    </form>
</div>

<script type="text/javascript">

$(document).on("click", "#add_member_button", function() {
    $.ajax({
        url: "{% url 'add_member' group.pk %}",
        data: {
            "csrfmiddlewaretoken": "{{ csrf_token }}",
            "username": $("#username_field").val()
        },
        type: "post",
        success: function(data) {
            document.getElementById("add_member_feedback").innerHTML = data;
        },
        failure: function(data) {
            console.log("failure");
            console.log(data);
        }
    });
    $("#username_field").val("");
})

</script>

{% endblock %}

{% block navbar %}
<div class="dropdown-divider border-light"></div>
<a class="nav-link" style="border-left: 1px;" href="{% url 'event_list' group.pk %}">{{ group.name }}</a>
{% endblock %}
